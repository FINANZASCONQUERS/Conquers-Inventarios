<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>Inventario Planta</title>
<style>
@page { size:A4 portrait; margin:15mm 15mm 18mm 15mm; }
body { font-family:'Segoe UI','Montserrat',Arial,sans-serif; font-size:12px; color:#2d3436; background:#f5f7fa; margin:0; }
.watermark { position:fixed; top:40%; left:15%; font-size:110px; color:#1b4f7215; transform:rotate(-25deg); }
.header { text-align:center; margin-bottom:8px; }
.brand { display:flex; flex-direction:column; align-items:center; gap:4px; }
.brand img { height:70px; }
h1 { font-size:22px; margin:4px 0 0; color:#1b4f72; letter-spacing:.5px; }
.periodo { font-size:11px; color:#546e7a; }
.badges { display:flex; justify-content:center; flex-wrap:wrap; gap:6px; margin-top:6px; }
.badge { background:#0b8552; color:#fff; padding:8px 12px; border-radius:8px; font-size:11px; font-weight:600; box-shadow:0 2px 4px #0b855233; }
.layout { border:1px solid #e0e6ec; background:#fff; border-radius:10px; padding:14px 18px 10px; }
table { width:100%; border-collapse:collapse; margin-top:4px; }
th, td { padding:7px 8px; border-bottom:1px solid #ecf0f1; }
th { text-align:left; font-size:11px; text-transform:uppercase; letter-spacing:.5px; background:#f4f7fb; color:#1b4f72; }
tbody tr:nth-child(even){ background:#fbfdff; }
tbody tr:hover { background:#eef7fa; }
td.numeric { text-align:right; font-variant-numeric:tabular-nums; }
.footer { margin-top:8px; font-size:10px; color:#8d99a6; text-align:right; }
</style>
</head>
<body>
<div class="watermark">CONQUERS</div>
<div class="header">
    <div class="brand">
        {% if logo_base64 %}
            <img src="data:image/jpeg;base64,{{ logo_base64 }}" alt="Logo" />
        {% else %}
            <div style="font-size:24px;font-weight:700;color:#1b4f72;">LOGO</div>
        {% endif %}
        <h1>Inventario de Planta</h1>
        <div class="periodo">{{ fecha_reporte }}</div>
        <div class="badges">
            <div class="badge">Total BLS @60°F: {{ '%.2f'|format(total_bls) }}</div>
            <div class="badge" style="background:#1e3c72;">Capacidad Total: {{ '%.2f'|format(total_cap) }}</div>
        </div>
    </div>
</div>

<div class="layout">
    <table>
        <thead>
            <tr>
                <th style="width:11%">TK</th>
                <th style="width:24%">Producto</th>
                <th style="width:13%">Cap. Máx.</th>
                <th style="width:13%">BLS @60°F</th>
                <th style="width:9%">API</th>
                <th style="width:9%">%BSW</th>
                <th style="width:9%">%S</th>
                <th style="width:12%">% Ocup.</th>
            </tr>
        </thead>
        <tbody>
            {% for r in registros %}
            {% set ocup = ( (r.bls_60 / r.max_cap) * 100 ) if r.max_cap else 0 %}
            <tr>
                <td>{{ r.tk }}</td>
                <td>{{ r.producto }}</td>
                <td class="numeric">{{ '%.0f'|format(r.max_cap) }}</td>
                <td class="numeric">{{ '%.0f'|format(r.bls_60) }}</td>
                <td class="numeric">{{ '%.1f'|format(r.api) }}</td>
                <td class="numeric">{{ '%.2f'|format(r.bsw) }}</td>
                <td class="numeric">{{ '%.2f'|format(r.s) }}</td>
                <td class="numeric">{{ '%.1f'|format(ocup) }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div class="footer">
    Generado: {{ fecha_generacion }} | Sistema Inventarios Conquers
</div>
</body>
</html>